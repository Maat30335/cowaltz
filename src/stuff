bool transmit(const Vector3f &v, const Vector3f &wh, double relativeIOR, Vector3f &wi){
    double cosThetaI = Dot(v, wh);
    double sin2ThetaI = std::max(0., (1 - cosThetaI * cosThetaI));
    double sin2ThetaT = relativeIOR * relativeIOR * sin2ThetaI;
    if(sin2ThetaT > 1) return false;
    double cosThetaT = std::sqrt(1 - sin2ThetaT);
    wi = relativeIOR * -v + (relativeIOR * cosThetaI - cosThetaT) * wh;
    return true;
}

bool transmit(const Vector3f &v, const Vector3f &wh, double relativeIOR, Vector3f &wi){
    double dotVH = Dot(v, wh);
    double sinTheta = relativeIOR * std::sqrt(1 - dotVH * dotVH);
    if(sinTheta > 1) return false;
    wi = relativeIOR * (-v) + (relativeIOR * dotVH - std::sqrt(1 - sinTheta * sinTheta)) * wh;
    return true;
}
